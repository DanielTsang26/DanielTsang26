<#
.SYNOPSIS
    This PowerShell script configures Windows to allow only secure Kerberos encryption types (AES128, AES256, and future types) 
    by setting the required registry value that disables DES and RC4.

.NOTES
    Author          : Daniel Tsang
    LinkedIn        : www.linkedin.com/in/daniel-tsang-58a772381
    GitHub          : github.com/DanielTsang26
    Date Created    : 2025-11-21
    Last Modified   : 2025-11-21
    Version         : 1.0
    CVEs            : N/A
    Plugin IDs      : N/A
    STIG-ID         : WN11-SO-000190

.TESTED ON
    Date(s) Tested  : 
    Tested By       : 
    Systems Tested  : 
    PowerShell Ver. : 

.USAGE
    Put any usage instructions here.
    Example syntax:
    PS C:\> .\__remediation_template(STIG-ID-WN11-SO-000190).ps1 
#>

# Registry path and value information
$RegPath = "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Kerberos\Parameters"
$ValueName = "SupportedEncryptionTypes"
$ValueData = 0x7ffffff8   # (2147483640)

# Create the registry key if it doesn't exist
if (-not (Test-Path $RegPath)) {
    New-Item -Path $RegPath -Force | Out-Null
}

# Set the registry value
Set-ItemProperty -Path $RegPath -Name $ValueName -Value $ValueData -Type DWord

# Verify the change
Get-ItemProperty -Path $RegPath -Name $ValueName
